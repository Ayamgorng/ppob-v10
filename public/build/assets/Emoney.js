import{r as s,j as e,a as y,y as O}from"./app.js";import{A as R,B as C}from"./AuthenticatedLayout.js";import{C as q}from"./Card.js";import{T as z,I as G}from"./TextInput.js";import{P as H}from"./PrimaryButton.js";import{S as J}from"./SelectInput.js";import K from"./Product.js";import{a as Q}from"./BaseHelper.js";import U from"./ProductSelectedDesc.js";import"./clsx.js";import"./ApplicationLogo.js";import"./transition.js";import"./keyboard.js";function ct({data:v,category:c,brands:k,csrf_token:W}){const[r,I]=s.useState(""),[E,B]=s.useState(!1),[_,A]=s.useState(""),[n,m]=s.useState(!1),[i,u]=s.useState(!1),[o,D]=s.useState(0),[d,f]=s.useState(0),[L,p]=s.useState(""),[x,h]=s.useState([]),g=new AbortController,T=g.signal,$=async()=>{if(o>0){m(!0),p("");const t=await y.get(`/transaction/list-product?id_category=${c.id}&id_brand=${o}`,{signal:T});h(t.data),m(!1)}else h([])},M=async()=>{var a,b,P,w,S,j,N;u(!0);const t=await y.post("/transaction/prepaid",{id_product:d,target:r});if((b=(a=t==null?void 0:t.data)==null?void 0:a.data)!=null&&b.id){C.success((P=t.data)==null?void 0:P.message),f(0),O.get(`/history/${(S=(w=t==null?void 0:t.data)==null?void 0:w.data)==null?void 0:S.id}`);return}else(j=t.data)!=null&&j.message&&C.error((N=t.data)==null?void 0:N.message);u(!1)};s.useEffect(()=>(l(r,0),$(),()=>{g.abort()}),[o]);const l=(t,a)=>{f(a),I(t),B(t.length>=10&&a>0)},V=t=>{const a=Q(t);A(a.length<10?"Number too short, minimim 10 number":""),l(a,d)},F=t=>{p(t.desc),l(r,t.id)};return e.jsx(R,{data:v,title:"Transaction",children:e.jsxs(q,{className:"flex flex-col px-10 gap-y-3 py-3",children:[e.jsx("h3",{className:"text-3xl font-medium mb-5 dark:text-white",children:c.name}),e.jsx(z,{title:"Phone Number/ID Customer",errorMessage:_,value:r,disabled:n||i,isFocused:!0,onChange:t=>V(t.target.value),className:"w-full md:w-1/3"}),e.jsx(G,{children:"Provider/Operator"}),e.jsx(J,{widthClass:"w-full md:w-1/3",data:k,value:o,onChange:D}),x.length>0&&e.jsx("label",{className:"dark:text-white",children:"Nominal"}),e.jsx("div",{className:"flex-wrap inline-flex min-w-full gap-8 max-h-96 overflow-y-auto rounded-sm",children:n?e.jsx("div",{className:"w-full text-center dark:text-white",children:"Processing..."}):x.map((t,a)=>e.jsx(K,{data:t,idProduct:d,onClick:()=>t.status&&F(t)},a))}),e.jsx(U,{description:L}),e.jsx("div",{className:"w-full text-right my-5",children:e.jsx(H,{loading:i,disabled:!E||n||i,onClick:()=>M(),children:"Process"})})]})})}export{ct as default};
