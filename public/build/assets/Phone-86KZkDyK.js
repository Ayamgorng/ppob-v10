import{r as a,j as e,b as I,a as b,y as L}from"./app-zG4up2OY.js";import{A as M}from"./AuthenticatedLayout-KagFa5dD.js";import{C as V}from"./Card-vP5jYToF.js";import{T as _}from"./TextInput-WrpmY6zO.js";import{P as B}from"./PrimaryButton-MSz8POA2.js";import F from"./Product-oTQ6pTan.js";import R from"./ProductSelectedDesc-BuKb9X32.js";import{f as q}from"./BaseHelper-6NPqXJkh.js";import"./clsx-Zbgk8kpT.js";import"./ApplicationLogo-M-cTcxWL.js";import"./transition-DPY1_IGr.js";function Z({auth:j,category:n}){const[o,i]=a.useState(""),[w,N]=a.useState(!1),[S,y]=a.useState(""),[v,c]=a.useState(!1),[l,d]=a.useState(!1),[r,m]=a.useState(0),[C,u]=a.useState(""),[f,k]=a.useState([]),h=new AbortController,T=h.signal,E=async()=>{c(!0),u("");const t=await b.get(`/transaction/list-product?id_category=${n.id}&phone=${o}`,{signal:T});k(t.data),c(!1)},A=async()=>{var s,p,g,P;d(!0);const t=await b.post("/transaction/prepaid",{id_product:r,target:o});console.log({result:t}),(p=(s=t==null?void 0:t.data)==null?void 0:s.data)!=null&&p.id&&(m(0),i(""),L.get(`/history/${(P=(g=t==null?void 0:t.data)==null?void 0:g.data)==null?void 0:P.id}`)),d(!1)};a.useEffect(()=>{const t=setTimeout(()=>{o.length>=4&&E()},1e3);return()=>{clearTimeout(t),h.abort()}},[o]);const x=(t,s)=>{m(s),i(t),N(t.length>=10&&s>0)},$=t=>{const s=q(t);y(s.length<10?"Number too short, minimim 10 number":""),x(s,r)},D=t=>{u(t.desc),x(o,t.id)};return e.jsxs(M,{auth:j,children:[e.jsx(I,{title:"Transaction"}),e.jsxs(V,{className:"flex flex-col px-10 gap-y-3 py-3",children:[e.jsx("h3",{className:"text-3xl font-medium mb-5 dark:text-white",children:n.name}),e.jsx(_,{title:"Phone Number",disabled:l,errorMessage:S,value:o,isFocused:!0,onChange:t=>$(t.target.value),className:"w-full md:w-1/3"}),f.length>0&&e.jsx("label",{className:"dark:text-white",children:"Nominal"}),e.jsx("div",{className:"flex-wrap inline-flex min-w-full gap-8 max-h-96 overflow-y-auto rounded-sm",children:v?e.jsx("div",{className:"w-full text-center dark:text-white",children:"Processing..."}):f.map((t,s)=>e.jsx(F,{data:t,idProduct:r,onClick:()=>t.status&&D(t)},s))}),e.jsx(R,{description:C}),e.jsx("div",{className:"w-full text-right my-5",children:e.jsx(B,{disabled:!w||l,onClick:()=>A(),children:"Process"})})]})]})}export{Z as default};
