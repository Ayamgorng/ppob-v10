import{r as a,j as e,a as y,y as O}from"./app-Bu5qAY3h.js";import{A as R}from"./AuthenticatedLayout-Cew62ZIr.js";import{C as q}from"./Card-B2LgLLI7.js";import{T as z,I as G}from"./TextInput-CiG5bZCT.js";import{P as H}from"./PrimaryButton-nmJZB-UY.js";import{S as J}from"./SelectInput-8FFh-kOl.js";import K from"./Product-DgrUdU_v.js";import{a as Q}from"./BaseHelper-CIKuMXkW.js";import U from"./ProductSelectedDesc-CJEdI-yn.js";import{B as C}from"./react-toastify.esm-DQCmDO0r.js";import{c as W}from"./clsx-B-dksMZM.js";import"./ApplicationLogo-D2vjWGdC.js";import"./transition-DaRqfOr-.js";import"./keyboard-DRMpaH0s.js";function ut({data:v,category:l,brands:k,csrf_token:X}){const[r,I]=a.useState(""),[E,B]=a.useState(!1),[A,D]=a.useState(""),[o,m]=a.useState(!1),[i,u]=a.useState(!1),[n,L]=a.useState(0),[d,p]=a.useState(0),[T,x]=a.useState(""),[f,g]=a.useState([]),h=new AbortController,_=h.signal,$=async()=>{if(n>0){m(!0),x("");const t=await y.get(`/transaction/list-product/${l.id}?id_brand=${n}`,{signal:_});g(t.data),m(!1)}else g([])},M=async()=>{var s,b,P,S,j,N,w;u(!0);const t=await y.post("/transaction/prepaid",{id_product:d,target:r});if((b=(s=t==null?void 0:t.data)==null?void 0:s.data)!=null&&b.id){C.success((P=t.data)==null?void 0:P.message),p(0),O.get(`/history/${(j=(S=t==null?void 0:t.data)==null?void 0:S.data)==null?void 0:j.id}`);return}else(N=t.data)!=null&&N.message&&C.error((w=t.data)==null?void 0:w.message);u(!1)};a.useEffect(()=>(c(r,0),$(),()=>{h.abort()}),[n]);const c=(t,s)=>{p(s),I(t),B(t.length>=10&&s>0)},V=t=>{const s=Q(t);D(s.length<10?"Number too short, minimim 10 number":""),c(s,d)},F=t=>{x(t.desc),c(r,t.id)};return e.jsx(R,{data:v,title:"Transaction",children:e.jsxs(q,{className:"flex flex-col md:px-10 p-6 gap-y-3",children:[e.jsx("h3",{className:"text-3xl font-medium mb-5 dark:text-white",children:l.name}),e.jsx(z,{title:"Phone Number/ID Customer",type:"tel",errorMessage:A,value:r,disabled:o||i,isFocused:!0,onChange:t=>V(t.target.value),className:"max-w-xl"}),e.jsx(G,{children:"Provider/Operator"}),e.jsx(J,{widthClass:"max-w-xl",data:k,value:n,onChange:L}),f.length>0&&e.jsx("label",{className:"dark:text-white",children:"Nominal"}),e.jsx("div",{className:W(!o&&"grid lg:grid-cols-5 md:grid-cols-3","gap-8 max-h-96 overflow-y-auto pr-5 rounded-sm"),children:o?e.jsx("div",{className:"w-full text-center dark:text-white",children:"Processing..."}):f.map((t,s)=>e.jsx(K,{data:t,idProduct:d,onClick:()=>t.status&&F(t)},s))}),e.jsx(U,{description:T}),e.jsx("div",{className:"w-full text-right my-5",children:e.jsx(H,{loading:i,disabled:!E||o||i,onClick:()=>M(),children:"Process"})})]})})}export{ut as default};
