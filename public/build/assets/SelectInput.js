import{r as s,t as Q,j as P}from"./app.js";import{c as X}from"./clsx.js";import{I as Re}from"./TextInput.js";import{s as ie,l as $,o as b,O as ee,U as C,y as F,u as E,p as H,g as Le,e as q,x as Ie,C as k,d as Te,c as J}from"./transition.js";import{c as De,h as Pe,T as we,f as $e,s as Ee,I as G,a as Ce,o as h,r as Fe,d as ke}from"./keyboard.js";function ae(e,r){let[t,o]=s.useState(e),i=ie(e);return $(()=>o(i.current),[i,o,...r]),t}function Ae(e,r,t){let[o,i]=s.useState(t),n=e!==void 0,a=s.useRef(n),l=s.useRef(!1),c=s.useRef(!1);return n&&!a.current&&!l.current?(l.current=!0,a.current=n,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!n&&a.current&&!c.current&&(c.current=!0,a.current=n,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[n?e:o,b(p=>(n||i(p),r==null?void 0:r(p)))]}function te(e){var r;if(e.type)return e.type;let t=(r=e.as)!=null?r:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function Ne(e,r){let[t,o]=s.useState(()=>te(e));return $(()=>{o(te(e))},[e.type,e.as]),$(()=>{t||r.current&&r.current instanceof HTMLButtonElement&&!r.current.hasAttribute("type")&&o("button")},[t,r]),t}function re(e){return[e.screenX,e.screenY]}function Me(){let e=s.useRef([-1,-1]);return{wasMoved(r){let t=re(r);return e.current[0]===t[0]&&e.current[1]===t[1]?!1:(e.current=t,!0)},update(r){e.current=re(r)}}}function je(e){throw new Error("Unexpected object: "+e)}var R=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(R||{});function Be(e,r){let t=r.resolveItems();if(t.length<=0)return null;let o=r.resolveActiveIndex(),i=o??-1;switch(e.focus){case 0:{for(let n=0;n<t.length;++n)if(!r.resolveDisabled(t[n],n,t))return n;return o}case 1:{for(let n=i-1;n>=0;--n)if(!r.resolveDisabled(t[n],n,t))return n;return o}case 2:{for(let n=i+1;n<t.length;++n)if(!r.resolveDisabled(t[n],n,t))return n;return o}case 3:{for(let n=t.length-1;n>=0;--n)if(!r.resolveDisabled(t[n],n,t))return n;return o}case 4:{for(let n=0;n<t.length;++n)if(r.resolveId(t[n],n,t)===e.id)return n;return o}case 5:return null;default:je(e)}}function le(e={},r=null,t=[]){for(let[o,i]of Object.entries(e))se(t,ue(r,o),i);return t}function ue(e,r){return e?e+"["+r+"]":r}function se(e,r,t){if(Array.isArray(t))for(let[o,i]of t.entries())se(e,ue(r,o.toString()),i);else t instanceof Date?e.push([r,t.toISOString()]):typeof t=="boolean"?e.push([r,t?"1":"0"]):typeof t=="string"?e.push([r,t]):typeof t=="number"?e.push([r,`${t}`]):t==null?e.push([r,""]):le(t,r,e)}function vt(e){var r,t;let o=(r=e==null?void 0:e.form)!=null?r:e.closest("form");if(o){for(let i of o.elements)if(i!==e&&(i.tagName==="INPUT"&&i.type==="submit"||i.tagName==="BUTTON"&&i.type==="submit"||i.nodeName==="INPUT"&&i.type==="image")){i.click();return}(t=o.requestSubmit)==null||t.call(o)}}let ne=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function oe(e){var r,t;let o=(r=e.innerText)!=null?r:"",i=e.cloneNode(!0);if(!(i instanceof HTMLElement))return o;let n=!1;for(let l of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),n=!0;let a=n?(t=i.innerText)!=null?t:"":o;return ne.test(a)&&(a=a.replace(ne,"")),a}function Ue(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let t=e.getAttribute("aria-labelledby");if(t){let o=t.split(" ").map(i=>{let n=document.getElementById(i);if(n){let a=n.getAttribute("aria-label");return typeof a=="string"?a.trim():oe(n).trim()}return null}).filter(Boolean);if(o.length>0)return o.join(", ")}return oe(e).trim()}function Qe(e){let r=s.useRef(""),t=s.useRef("");return b(()=>{let o=e.current;if(!o)return"";let i=o.innerText;if(r.current===i)return t.current;let n=Ue(o).trim().toLowerCase();return r.current=i,t.current=n,n})}var ze=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ze||{}),He=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(He||{}),qe=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(qe||{}),Ge=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(Ge||{});function Y(e,r=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=ke(r(e.options.slice()),n=>n.dataRef.current.domRef.current),i=t?o.indexOf(t):null;return i===-1&&(i=null),{options:o,activeOptionIndex:i}}let Ke={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let r=e.activeOptionIndex,{isSelected:t}=e.dataRef.current,o=e.options.findIndex(i=>t(i.dataRef.current.value));return o!==-1&&(r=o),{...e,listboxState:0,activeOptionIndex:r}},2(e,r){var t;if(e.dataRef.current.disabled||e.listboxState===1)return e;let o=Y(e),i=Be(r,{resolveItems:()=>o.options,resolveActiveIndex:()=>o.activeOptionIndex,resolveId:n=>n.id,resolveDisabled:n=>n.dataRef.current.disabled});return{...e,...o,searchQuery:"",activeOptionIndex:i,activationTrigger:(t=r.trigger)!=null?t:1}},3:(e,r)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let t=e.searchQuery!==""?0:1,o=e.searchQuery+r.value.toLowerCase(),i=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+t).concat(e.options.slice(0,e.activeOptionIndex+t)):e.options).find(a=>{var l;return!a.dataRef.current.disabled&&((l=a.dataRef.current.textValue)==null?void 0:l.startsWith(o))}),n=i?e.options.indexOf(i):-1;return n===-1||n===e.activeOptionIndex?{...e,searchQuery:o}:{...e,searchQuery:o,activeOptionIndex:n,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,r)=>{let t={id:r.id,dataRef:r.dataRef},o=Y(e,i=>[...i,t]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(r.dataRef.current.value)&&(o.activeOptionIndex=o.options.indexOf(t)),{...e,...o}},6:(e,r)=>{let t=Y(e,o=>{let i=o.findIndex(n=>n.id===r.id);return i!==-1&&o.splice(i,1),o});return{...e,...t,activationTrigger:1}},7:(e,r)=>({...e,labelId:r.id})},Z=s.createContext(null);Z.displayName="ListboxActionsContext";function A(e){let r=s.useContext(Z);if(r===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,A),t}return r}let V=s.createContext(null);V.displayName="ListboxDataContext";function N(e){let r=s.useContext(V);if(r===null){let t=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,N),t}return r}function We(e,r){return E(r.type,Ke,e,r)}let Xe=s.Fragment;function Ye(e,r){let{value:t,defaultValue:o,form:i,name:n,onChange:a,by:l=(d,f)=>d===f,disabled:c=!1,horizontal:p=!1,multiple:g=!1,...I}=e;const w=p?"horizontal":"vertical";let T=F(r),[O=g?[]:void 0,L]=Ae(t,a,o),[x,u]=s.useReducer(We,{dataRef:s.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),m=s.useRef({static:!1,hold:!1}),M=s.useRef(null),j=s.useRef(null),K=s.useRef(null),y=b(typeof l=="string"?(d,f)=>{let S=l;return(d==null?void 0:d[S])===(f==null?void 0:f[S])}:l),D=s.useCallback(d=>E(v.mode,{1:()=>O.some(f=>y(f,d)),0:()=>y(O,d)}),[O]),v=s.useMemo(()=>({...x,value:O,disabled:c,mode:g?1:0,orientation:w,compare:y,isSelected:D,optionsPropsRef:m,labelRef:M,buttonRef:j,optionsRef:K}),[O,c,g,x]);$(()=>{x.dataRef.current=v},[v]),De([v.buttonRef,v.optionsRef],(d,f)=>{var S;u({type:1}),Pe(f,we.Loose)||(d.preventDefault(),(S=v.buttonRef.current)==null||S.focus())},v.listboxState===0);let ce=s.useMemo(()=>({open:v.listboxState===0,disabled:c,value:O}),[v,c,O]),de=b(d=>{let f=v.options.find(S=>S.id===d);f&&W(f.dataRef.current.value)}),pe=b(()=>{if(v.activeOptionIndex!==null){let{dataRef:d,id:f}=v.options[v.activeOptionIndex];W(d.current.value),u({type:2,focus:R.Specific,id:f})}}),fe=b(()=>u({type:0})),be=b(()=>u({type:1})),ve=b((d,f,S)=>d===R.Specific?u({type:2,focus:R.Specific,id:f,trigger:S}):u({type:2,focus:d,trigger:S})),xe=b((d,f)=>(u({type:5,id:d,dataRef:f}),()=>u({type:6,id:d}))),ge=b(d=>(u({type:7,id:d}),()=>u({type:7,id:null}))),W=b(d=>E(v.mode,{0(){return L==null?void 0:L(d)},1(){let f=v.value.slice(),S=f.findIndex(U=>y(U,d));return S===-1?f.push(d):f.splice(S,1),L==null?void 0:L(f)}})),me=b(d=>u({type:3,value:d})),he=b(()=>u({type:4})),Oe=s.useMemo(()=>({onChange:W,registerOption:xe,registerLabel:ge,goToOption:ve,closeListbox:be,openListbox:fe,selectActiveOption:pe,selectOption:de,search:me,clearSearch:he}),[]),ye={ref:T},B=s.useRef(null),Se=H();return s.useEffect(()=>{B.current&&o!==void 0&&Se.addEventListener(B.current,"reset",()=>{L==null||L(o)})},[B,L]),Q.createElement(Z.Provider,{value:Oe},Q.createElement(V.Provider,{value:v},Q.createElement(Le,{value:E(v.listboxState,{0:q.Open,1:q.Closed})},n!=null&&O!=null&&le({[n]:O}).map(([d,f],S)=>Q.createElement($e,{features:Ee.Hidden,ref:S===0?U=>{var _;B.current=(_=U==null?void 0:U.closest("form"))!=null?_:null}:void 0,...Ie({key:d,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:i,name:d,value:f})})),k({ourProps:ye,theirProps:I,slot:ce,defaultTag:Xe,name:"Listbox"}))))}let Je="button";function Ze(e,r){var t;let o=G(),{id:i=`headlessui-listbox-button-${o}`,...n}=e,a=N("Listbox.Button"),l=A("Listbox.Button"),c=F(a.buttonRef,r),p=H(),g=b(x=>{switch(x.key){case h.Space:case h.Enter:case h.ArrowDown:x.preventDefault(),l.openListbox(),p.nextFrame(()=>{a.value||l.goToOption(R.First)});break;case h.ArrowUp:x.preventDefault(),l.openListbox(),p.nextFrame(()=>{a.value||l.goToOption(R.Last)});break}}),I=b(x=>{switch(x.key){case h.Space:x.preventDefault();break}}),w=b(x=>{if(Fe(x.currentTarget))return x.preventDefault();a.listboxState===0?(l.closeListbox(),p.nextFrame(()=>{var u;return(u=a.buttonRef.current)==null?void 0:u.focus({preventScroll:!0})})):(x.preventDefault(),l.openListbox())}),T=ae(()=>{if(a.labelId)return[a.labelId,i].join(" ")},[a.labelId,i]),O=s.useMemo(()=>({open:a.listboxState===0,disabled:a.disabled,value:a.value}),[a]),L={ref:c,id:i,type:Ne(e,a.buttonRef),"aria-haspopup":"listbox","aria-controls":(t=a.optionsRef.current)==null?void 0:t.id,"aria-expanded":a.listboxState===0,"aria-labelledby":T,disabled:a.disabled,onKeyDown:g,onKeyUp:I,onClick:w};return k({ourProps:L,theirProps:n,slot:O,defaultTag:Je,name:"Listbox.Button"})}let Ve="label";function _e(e,r){let t=G(),{id:o=`headlessui-listbox-label-${t}`,...i}=e,n=N("Listbox.Label"),a=A("Listbox.Label"),l=F(n.labelRef,r);$(()=>a.registerLabel(o),[o]);let c=b(()=>{var g;return(g=n.buttonRef.current)==null?void 0:g.focus({preventScroll:!0})}),p=s.useMemo(()=>({open:n.listboxState===0,disabled:n.disabled}),[n]);return k({ourProps:{ref:l,id:o,onClick:c},theirProps:i,slot:p,defaultTag:Ve,name:"Listbox.Label"})}let et="ul",tt=ee.RenderStrategy|ee.Static;function rt(e,r){var t;let o=G(),{id:i=`headlessui-listbox-options-${o}`,...n}=e,a=N("Listbox.Options"),l=A("Listbox.Options"),c=F(a.optionsRef,r),p=H(),g=H(),I=Te(),w=I!==null?(I&q.Open)===q.Open:a.listboxState===0;s.useEffect(()=>{var u;let m=a.optionsRef.current;m&&a.listboxState===0&&m!==((u=Ce(m))==null?void 0:u.activeElement)&&m.focus({preventScroll:!0})},[a.listboxState,a.optionsRef]);let T=b(u=>{switch(g.dispose(),u.key){case h.Space:if(a.searchQuery!=="")return u.preventDefault(),u.stopPropagation(),l.search(u.key);case h.Enter:if(u.preventDefault(),u.stopPropagation(),a.activeOptionIndex!==null){let{dataRef:m}=a.options[a.activeOptionIndex];l.onChange(m.current.value)}a.mode===0&&(l.closeListbox(),J().nextFrame(()=>{var m;return(m=a.buttonRef.current)==null?void 0:m.focus({preventScroll:!0})}));break;case E(a.orientation,{vertical:h.ArrowDown,horizontal:h.ArrowRight}):return u.preventDefault(),u.stopPropagation(),l.goToOption(R.Next);case E(a.orientation,{vertical:h.ArrowUp,horizontal:h.ArrowLeft}):return u.preventDefault(),u.stopPropagation(),l.goToOption(R.Previous);case h.Home:case h.PageUp:return u.preventDefault(),u.stopPropagation(),l.goToOption(R.First);case h.End:case h.PageDown:return u.preventDefault(),u.stopPropagation(),l.goToOption(R.Last);case h.Escape:return u.preventDefault(),u.stopPropagation(),l.closeListbox(),p.nextFrame(()=>{var m;return(m=a.buttonRef.current)==null?void 0:m.focus({preventScroll:!0})});case h.Tab:u.preventDefault(),u.stopPropagation();break;default:u.key.length===1&&(l.search(u.key),g.setTimeout(()=>l.clearSearch(),350));break}}),O=ae(()=>{var u;return(u=a.buttonRef.current)==null?void 0:u.id},[a.buttonRef.current]),L=s.useMemo(()=>({open:a.listboxState===0}),[a]),x={"aria-activedescendant":a.activeOptionIndex===null||(t=a.options[a.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":a.mode===1?!0:void 0,"aria-labelledby":O,"aria-orientation":a.orientation,id:i,onKeyDown:T,role:"listbox",tabIndex:0,ref:c};return k({ourProps:x,theirProps:n,slot:L,defaultTag:et,features:tt,visible:w,name:"Listbox.Options"})}let nt="li";function ot(e,r){let t=G(),{id:o=`headlessui-listbox-option-${t}`,disabled:i=!1,value:n,...a}=e,l=N("Listbox.Option"),c=A("Listbox.Option"),p=l.activeOptionIndex!==null?l.options[l.activeOptionIndex].id===o:!1,g=l.isSelected(n),I=s.useRef(null),w=Qe(I),T=ie({disabled:i,value:n,domRef:I,get textValue(){return w()}}),O=F(r,I);$(()=>{if(l.listboxState!==0||!p||l.activationTrigger===0)return;let y=J();return y.requestAnimationFrame(()=>{var D,v;(v=(D=I.current)==null?void 0:D.scrollIntoView)==null||v.call(D,{block:"nearest"})}),y.dispose},[I,p,l.listboxState,l.activationTrigger,l.activeOptionIndex]),$(()=>c.registerOption(o,T),[T,o]);let L=b(y=>{if(i)return y.preventDefault();c.onChange(n),l.mode===0&&(c.closeListbox(),J().nextFrame(()=>{var D;return(D=l.buttonRef.current)==null?void 0:D.focus({preventScroll:!0})}))}),x=b(()=>{if(i)return c.goToOption(R.Nothing);c.goToOption(R.Specific,o)}),u=Me(),m=b(y=>u.update(y)),M=b(y=>{u.wasMoved(y)&&(i||p||c.goToOption(R.Specific,o,0))}),j=b(y=>{u.wasMoved(y)&&(i||p&&c.goToOption(R.Nothing))}),K=s.useMemo(()=>({active:p,selected:g,disabled:i}),[p,g,i]);return k({ourProps:{id:o,ref:O,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":g,disabled:void 0,onClick:L,onFocus:x,onPointerEnter:m,onMouseEnter:m,onPointerMove:M,onMouseMove:M,onPointerLeave:j,onMouseLeave:j},theirProps:a,slot:K,defaultTag:nt,name:"Listbox.Option"})}let it=C(Ye),at=C(Ze),lt=C(_e),ut=C(rt),st=C(ot),z=Object.assign(it,{Button:at,Label:lt,Options:ut,Option:st});function xt({data:e,title:r,value:t,onChange:o,widthClass:i,disabled:n=!1}){const a=s.useMemo(()=>{let c={};return[{id:0,name:"Choose"},...e].forEach(p=>{c[p.id]=p}),Object.values(c)},[e]),l=a.find(c=>c.id===t);return P.jsxs("div",{children:[r&&P.jsx(Re,{value:r,className:"mb-2"}),P.jsx("div",{className:"w-full relative",children:P.jsxs(z,{value:l,onChange:c=>o(c.id),disabled:n,children:[P.jsx(z.Button,{className:X("dark:bg-gray-100 rounded px-3 py-2 text-left disabled:opacity-70",i),children:l==null?void 0:l.name}),P.jsx(z.Options,{className:X("absolute top-[110%] max-h-80 overflow-y-auto z-10",i),children:a.map(c=>P.jsx(z.Option,{value:c,as:s.Fragment,children:({active:p,selected:g})=>P.jsx("li",{className:X("py-1 pl-3 flex items-center bg-white",p&&"dark:bg-gray-500 text-white ",(l==null?void 0:l.id)!==void 0&&(l==null?void 0:l.id)>0&&g&&"dark:bg-gray-600 text-white "),children:c.name})},c.id))})]})})]})}export{xt as S,Ae as T,Ne as a,vt as p};
